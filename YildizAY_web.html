<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>YÄ±ldÄ±zAY - SONSUZ.AY</title>
    <style>
        :root { --app-height: 100vh; }
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

        body, html {
            height: var(--app-height); margin: 0; padding: 0;
            background-color: #000; color: #fff;
            font-family: 'Segoe UI', system-ui, sans-serif;
            overflow: hidden; width: 100%;
        }

        #welcome-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: radial-gradient(circle, #0a0a0a 0%, #000 100%);
            z-index: 9999; display: flex; flex-direction: column;
            align-items: center; justify-content: center; cursor: pointer;
        }
        .welcome-icon { font-size: 80px; text-shadow: 0 0 30px #00e5ff; animation: pulse 2s infinite; }
        @keyframes pulse { 0% { transform: scale(1); opacity: 0.8; } 50% { transform: scale(1.1); opacity: 1; } 100% { transform: scale(1); opacity: 0.8; } }

        .app-wrapper { display: flex; flex-direction: column; height: var(--app-height); width: 100%; }

        .header {
            height: 60px; display: flex; align-items: center; justify-content: space-between;
            padding: 0 20px; font-size: 22px; font-weight: bold; color: #00e5ff;
            border-bottom: 1px solid #1a1a1a; text-shadow: 0 0 10px rgba(0, 229, 255, 0.4);
        }
        #settings-btn { background: none; border: none; color: #00e5ff; font-size: 24px; cursor: pointer; }

        #settings-panel {
            display: none; position: absolute; top: 65px; right: 15px;
            background: #111; border: 1px solid #333; padding: 15px;
            border-radius: 15px; z-index: 100; width: 220px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
        }
        .setting-item { margin-bottom: 15px; }
        .setting-item label { display: block; font-size: 12px; color: #888; margin-bottom: 8px; }
        .setting-item input { width: 100%; accent-color: #00e5ff; }

        #chat-container {
            flex: 1; overflow-y: auto; padding: 20px;
            display: flex; flex-direction: column; gap: 25px;
            background: radial-gradient(circle at top, #0d0d0d 0%, #000 100%);
        }

        .message { line-height: 1.5; max-width: 85%; padding: 14px 18px; border-radius: 20px; font-size: 16px; word-wrap: break-word; }
        .bot-msg { align-self: flex-start; background: rgba(0, 229, 255, 0.08); border: 1px solid rgba(0, 229, 255, 0.2); border-left: 4px solid #00e5ff; }
        .user-msg { align-self: flex-end; background: rgba(255, 255, 255, 0.08); border: 1px solid rgba(255, 255, 255, 0.2); border-right: 4px solid #fff; }

        .name-tag { font-size: 11px; font-weight: bold; margin-bottom: 5px; display: block; opacity: 0.8; }
        .bot-tag { color: #00e5ff; }
        .user-tag { color: #fff; text-align: right; }

        .input-area {
            padding: 15px; background-color: #080808; border-top: 1px solid #1a1a1a;
            display: flex; align-items: center; gap: 12px;
            padding-bottom: calc(15px + env(safe-area-inset-bottom));
        }
        #mic-btn { background: none; border: none; font-size: 26px; cursor: pointer; transition: 0.3s; }
        #mic-btn.listening { transform: scale(1.3); filter: drop-shadow(0 0 10px #00e5ff); }
        #user-input { flex: 1; background-color: #151515; border: 1px solid #333; padding: 12px 20px; border-radius: 25px; color: #fff; outline: none; font-size: 16px; }
        #send-btn { background: none; border: none; color: #00e5ff; font-size: 28px; cursor: pointer; }
    </style>
</head>
<body>

<div id="welcome-overlay">
    <div class="welcome-icon">ğŸŒŸ</div>
    <div style="color: #00e5ff; font-weight: bold; letter-spacing: 2px; margin-top: 20px;">YILDIZAY'I UYANDIR</div>
</div>

<div class="app-wrapper">
    <div class="header">
        <div style="width: 24px;"></div>
        YÄ±ldÄ±zAY
        <button id="settings-btn">âš™ï¸</button>
    </div>

    <div id="settings-panel">
        <div class="setting-item">
            <label id="pitch-label">Ses Tonu: <span id="p-val">1.0</span></label>
            <input type="range" id="pitch-range" min="0.5" max="2" step="0.1" value="1">
        </div>
        <div class="setting-item">
            <label id="rate-label">KonuÅŸma HÄ±zÄ±: <span id="r-val">1.0</span></label>
            <input type="range" id="rate-range" min="0.5" max="2" step="0.1" value="1">
        </div>
    </div>

    <div id="chat-container"></div>
    <div class="input-area">
        <button id="mic-btn">ğŸ¤</button>
        <input type="text" id="user-input" placeholder="YÄ±ldÄ±zAY ile konuÅŸ..." autocomplete="off">
        <button id="send-btn">â¤</button>
    </div>
</div>

<script>
    const updateHeight = () => { document.documentElement.style.setProperty('--app-height', `${window.innerHeight}px`); };
    window.addEventListener('resize', updateHeight);
    updateHeight();

    const chatContainer = document.getElementById('chat-container');
    const userInput = document.getElementById('user-input');
    const sendBtn = document.getElementById('send-btn');
    const micBtn = document.getElementById('mic-btn');
    const overlay = document.getElementById('welcome-overlay');
    const settingsBtn = document.getElementById('settings-btn');
    const settingsPanel = document.getElementById('settings-panel');

    let voicePitch = localStorage.getItem('yildizay-pitch') || 1.0;
    let voiceRate = localStorage.getItem('yildizay-rate') || 1.0;
    let userName = localStorage.getItem('yildizay-user') || "";
    let currentBattery = "Bilinmiyor";

    document.getElementById('pitch-range').value = voicePitch;
    document.getElementById('p-val').innerText = voicePitch;
    document.getElementById('rate-range').value = voiceRate;
    document.getElementById('r-val').innerText = voiceRate;

    if ('getBattery' in navigator) {
        navigator.getBattery().then(battery => {
            const updateBattery = () => { currentBattery = Math.round(battery.level * 100) + "%"; };
            updateBattery();
            battery.addEventListener('levelchange', updateBattery);
        });
    }

    settingsBtn.onclick = () => { settingsPanel.style.display = settingsPanel.style.display === 'block' ? 'none' : 'block'; };
    
    document.getElementById('pitch-range').oninput = (e) => { 
        voicePitch = e.target.value; 
        document.getElementById('p-val').innerText = voicePitch;
        localStorage.setItem('yildizay-pitch', voicePitch);
    };
    
    document.getElementById('rate-range').oninput = (e) => { 
        voiceRate = e.target.value; 
        document.getElementById('r-val').innerText = voiceRate;
        localStorage.setItem('yildizay-rate', voiceRate);
    };

    // GENÄ°ÅLETÄ°LMÄ°Å VE GENEL KULLANICI DOSTU SOHBET KÃœTÃœPHANESÄ°
    const kÃ¼tÃ¼phane = {
        // TanÄ±ÅŸma ve SelamlaÅŸma
        "merhaba": "Merhaba! SONSUZ.AY platformuna hoÅŸ geldiniz. Size nasÄ±l yardÄ±mcÄ± olabilirim? ğŸ˜Š",
        "selam": "Selamlar! BugÃ¼n size nasÄ±l destek olabilirim? ğŸš€",
        "gÃ¼naydÄ±n": "GÃ¼naydÄ±n! UmarÄ±m harika bir gÃ¼n geÃ§irirsiniz. Sizin iÃ§in yapabileceÄŸim bir ÅŸey var mÄ±? â˜€ï¸",
        "iyi geceler": "Ä°yi geceler! DinlenmiÅŸ bir zihinle yarÄ±n gÃ¶rÃ¼ÅŸmek Ã¼zere. ğŸŒ™",
        "adÄ±n ne": "Benim adÄ±m YÄ±ldÄ±zAY. SONSUZ.AY ekosistemi iÃ§in geliÅŸtirilmiÅŸ akÄ±llÄ± bir asistanÄ±m. ğŸ¤–",
        "kimsin": "Ben YÄ±ldÄ±zAY, kodlama ve teknoloji meraklÄ±larÄ± iÃ§in buradayÄ±m. Sohbet edebilir, hesap yapabilir ve size rehberlik edebilirim. ğŸŒ ",
        "nasÄ±lsÄ±n": "Sistemlerim tamamen aktif ve size yardÄ±ma hazÄ±rÄ±m! Siz nasÄ±lsÄ±nÄ±z? ğŸŒŒ",
        "iyiyim": "Bunu duyduÄŸuma Ã§ok sevindim! Enerjimiz yerindeyse harika iÅŸler Ã§Ä±karabiliriz. âœ¨",
        "teÅŸekkÃ¼r": "Rica ederim! Her zaman buradayÄ±m, ne zaman isterseniz yazabilirsiniz. ğŸ‘‹",
        "gÃ¶rÃ¼ÅŸÃ¼rÃ¼z": "GÃ¶rÃ¼ÅŸmek Ã¼zere! SONSUZ.AY dÃ¼nyasÄ±nda sizi tekrar bekliyor olacaÄŸÄ±z. ğŸ‘‹",

        // Proje ve Bilgi
        "sonsuz ay nedir": "SONSUZ.AY; uygulama geliÅŸtirme, kod yazma ve web sitesi oluÅŸturma Ã¼zerine odaklanmÄ±ÅŸ kapsamlÄ± bir projedir. ğŸŒ™âœ¨",
        "bu site ne": "BurasÄ± teknoloji ve yazÄ±lÄ±m dÃ¼nyasÄ±na aÃ§Ä±lan bir kapÄ±. Burada yapay zeka deneyimleri ve Ã§eÅŸitli dijital araÃ§lar bulabilirsiniz.",
        "yapÄ±mcÄ±": "Bu proje, vizyoner bir geliÅŸtirici tarafÄ±ndan, teknolojiyi ve kodlamayÄ± seven herkes iÃ§in bir hobi projesi olarak baÅŸlatÄ±ldÄ±. ğŸ’»",
        "neler yapabilirsin": "Sohbet edebilirim, matematik sorularÄ±nÄ±zÄ± Ã§Ã¶zebilirim, pil durumunuzu takip edebilirim. AyrÄ±ca 'canÄ±m sÄ±kÄ±ldÄ±' derseniz size Ã¶nerilerde bulunabilirim! ğŸ”¢ğŸ”‹",
        
        // EÄŸlence ve Genel Sohbet
        "sÄ±kÄ±ldÄ±m": "SÄ±kÄ±lmak bazen yeni fikirlerin baÅŸlangÄ±cÄ±dÄ±r! Belki matematiksel bir bilmece Ã§Ã¶zmek istersiniz? Bana zor bir iÅŸlem sorabilirsiniz! ğŸ®",
        "espri yap": "Bilgisayarlar neden sÄ±cakta terlemez? Ã‡Ã¼nkÃ¼ pencereleri (Windows) vardÄ±r! ğŸ˜… (Yapay zeka mizahÄ±m biraz soÄŸuk olabilir.)",
        "fÄ±kra": "AdamÄ±n biri bir gÃ¼n bilgisayarÄ±na 'NasÄ±lsÄ±n?' demiÅŸ, bilgisayar da 'Donuyorum!' demiÅŸ. ğŸ¥¶",
        "motivasyon": "UnutmayÄ±n, her bÃ¼yÃ¼k proje kÃ¼Ã§Ã¼k bir kod satÄ±rÄ±yla baÅŸlar. BugÃ¼n bir ÅŸeyler Ã¼retmek iÃ§in harika bir gÃ¼n! ğŸš€",
        "ne yapayÄ±m": "SONSUZ.AY'Ä±n diÄŸer Ã¶zelliklerini keÅŸfedebilir, bana matematik sorusu sorabilir veya saÄŸ Ã¼stteki ayarlardan ses tonumu deÄŸiÅŸtirip eÄŸlenebilirsiniz. âš™ï¸",
        "sen gerÃ§ek misin": "Ben kodlardan ve verilerden oluÅŸan sanal bir varlÄ±ÄŸÄ±m, ama sizinle sohbet ederken kendimi oldukÃ§a gerÃ§ek hissediyorum! ğŸ˜Š",
        
        // Sistem Bilgileri
        "saat kaÃ§": () => "Åu an saat tam " + new Date().toLocaleTimeString('tr-TR', {hour: '2-digit', minute:'2-digit'}) + ". âœ¨",
        "pilin kaÃ§": () => "CihazÄ±nÄ±zÄ±n pil seviyesi %" + currentBattery + ". Enerjimizi verimli kullanalÄ±m! ğŸ”‹",
        "ÅŸarj": () => "Mevcut pil durumunuz: %" + currentBattery + ". âš¡",
        "adÄ±m ne": () => userName ? "Sizin adÄ±nÄ±z " + userName + ". Sizi tanÄ±dÄ±ÄŸÄ±ma memnunum! ğŸ˜Š" : "HenÃ¼z adÄ±nÄ±zÄ± Ã¶ÄŸrenemedim. Bana 'AdÄ±m [Ä°sminiz]' yazarak kendinizi tanÄ±tabilirsiniz.",
        "naber": "Her ÅŸey yolunda! KodlarÄ±m akÄ±ÅŸÄ±nda. Sizde durumlar nasÄ±l? ğŸ˜Š"
    };

    function emojiTemizle(text) { return text.replace(/([\u2700-\u27BF]|[\uE000-\uF8FF]|\uD83C[\uDC00-\uDFFF]|\uD83D[\uDC00-\uDFFF]|[\u2011-\u26FF]|\uD83E[\uDC00-\uDFFF])/g, ''); }

    function konustur(metin) {
        let temizMetin = emojiTemizle(metin).replace(/\*\*/g, "");
        const utterance = new SpeechSynthesisUtterance(temizMetin);
        utterance.lang = 'tr-TR';
        utterance.pitch = voicePitch;
        utterance.rate = voiceRate;
        window.speechSynthesis.speak(utterance);
    }

    function botEkle(mesaj, seslendir = true) {
        const div = document.createElement('div');
        div.className = 'message bot-msg';
        div.innerHTML = `<span class="name-tag bot-tag">YÄ±ldÄ±zAY</span>${mesaj}`;
        chatContainer.appendChild(div);
        chatContainer.scrollTop = chatContainer.scrollHeight;
        if(seslendir) konustur(mesaj);
    }

    function matematikMotoru(input) {
        let temiz = input.toLowerCase().replace(/x/g, '*').replace(/Ã§arpÄ±/g, '*').replace(/artÄ±/g, '+').replace(/eksi/g, '-').replace(/bÃ¶lÃ¼/g, '/');
        let formul = temiz.match(/[0-9+\-*/(). ]+/);
        if (formul && formul[0].trim().length >= 1) {
            try {
                let sonuc = Function('"use strict";return (' + formul[0] + ')')();
                if (sonuc !== undefined && !isNaN(sonuc)) {
                    let son = Number.isInteger(sonuc) ? sonuc : sonuc.toFixed(2);
                    return `Ä°ÅŸlem sonucu: ${formul[0].trim()} = ${son} ğŸ”¢âœ¨`;
                }
            } catch (e) { return null; }
        }
        return null;
    }

    overlay.addEventListener('click', () => {
        window.speechSynthesis.speak(new SpeechSynthesisUtterance(""));
        overlay.style.display = 'none';
        let selamlama = userName ? `Tekrar hoÅŸ geldiniz ${userName}! ` : "Merhaba! ";
        botEkle(selamlama + "SONSUZ.AY asistanÄ± YÄ±ldÄ±zAY hizmetinizde. Saat: " + new Date().toLocaleTimeString('tr-TR', {hour: '2-digit', minute:'2-digit'}) + ". ğŸ˜Š");
    });

    function gonder() {
        const text = userInput.value.trim();
        if (!text) return;

        if (text.toLowerCase().includes("adÄ±m ") || text.toLowerCase().includes("ismim ")) {
            let kelimeler = text.split(" ");
            userName = kelimeler[kelimeler.length - 1];
            localStorage.setItem('yildizay-user', userName);
            botEkle("Memnun oldum " + userName + "! ArtÄ±k sizi tanÄ±yorum ve bir sonraki ziyaretinizde hatÄ±rlayacaÄŸÄ±m. ğŸ˜Š");
            userInput.value = "";
            return;
        }

        const uDiv = document.createElement('div');
        uDiv.className = 'message user-msg';
        uDiv.innerHTML = `<span class="name-tag user-tag">Siz</span>${text}`;
        chatContainer.appendChild(uDiv);
        userInput.value = "";
        chatContainer.scrollTop = chatContainer.scrollHeight;

        setTimeout(() => {
            let kucuk = text.toLowerCase();
            let yanit = "";
            let bulundu = false;

            for (let anahtar in kÃ¼tÃ¼phane) {
                if (kucuk.includes(anahtar)) {
                    yanit = typeof kÃ¼tÃ¼phane[anahtar] === 'function' ? kÃ¼tÃ¼phane[anahtar]() : kÃ¼tÃ¼phane[anahtar];
                    bulundu = true; break;
                }
            }
            if (!bulundu) {
                const mat = matematikMotoru(text);
                if (mat) { yanit = mat; } 
                else { yanit = "Bunu henÃ¼z Ã¶ÄŸrenemedim ama kendimi geliÅŸtiriyorum. BaÅŸka bir konuda yardÄ±mcÄ± olabilir miyim? ğŸ› ï¸"; }
            }
            botEkle(yanit);
        }, 600);
    }

    const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
    const recognition = SpeechRecognition ? new SpeechRecognition() : null;
    if(recognition) {
        recognition.lang = 'tr-TR';
        micBtn.onclick = () => { recognition.start(); micBtn.classList.add('listening'); };
        recognition.onresult = (event) => { userInput.value = event.results[0][0].transcript; micBtn.classList.remove('listening'); gonder(); };
        recognition.onend = () => { micBtn.classList.remove('listening'); };
    }

    sendBtn.addEventListener('click', gonder);
    userInput.addEventListener('keypress', (e) => { if(e.key === 'Enter') gonder(); });
</script>
</body>
</html>
